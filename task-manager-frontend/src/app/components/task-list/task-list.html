<div class="task-container">
  <h2>📝 Your Tasks</h2>

  <div class="create-task-wrapper">
    <button (click)="toggleForm()" class="create-task-button">
      {{ showForm ? 'Cancel' : '➕ Create New Task' }}
    </button>
  </div>

  <!-- Create / Edit Task Form -->
  <form *ngIf="showForm" (ngSubmit)="submitForm()" #taskForm="ngForm" class="task-form">
    <div class="form-row">
      <label for="title">Title:</label>
      <input id="title" name="title" type="text" [(ngModel)]="newTask.title" required />
    </div>

    <div class="form-row">
      <label for="description">Description:</label>
      <textarea id="description" name="description" [(ngModel)]="newTask.description" rows="3"></textarea>
    </div>

    <div class="form-row">
      <label for="completed">Completed:</label>
      <select id="completed" name="completed" [(ngModel)]="newTask.completed" required>
        <option [ngValue]="false">No</option>
        <option [ngValue]="true">Yes</option>
      </select>
    </div>

    <div class="form-row">
      <label for="dueDate">Due Date:</label>
      <input id="dueDate" name="dueDate" type="date" [(ngModel)]="newTask.dueDate" required />
    </div>

    <div class="form-row">
      <label for="priority">Priority:</label>
      <select id="priority" name="priority" [(ngModel)]="newTask.priority" required>
        <option value="Low">Low</option>
        <option value="Medium">Medium</option>
        <option value="High">High</option>
      </select>
    </div>

    <div class="form-actions">
      <button type="submit" [disabled]="taskForm.invalid">
        {{ editingTask ? 'Update Task' : 'Add Task' }}
      </button>
      <button type="button" (click)="cancelEdit()">Cancel</button>
    </div>

    <div *ngIf="error" class="status-message error">{{ error }}</div>
  </form>

  <div *ngIf="loading" class="status-message">Loading tasks...</div>

  <ul class="task-list">
    <li *ngFor="let task of tasks" [class.completed]="task.completed">
      <div class="task-details">
        <input type="checkbox" [checked]="task.completed" (change)="toggleComplete(task)" />
        <div class="task-content">
          <h4>{{ task.title }}</h4>
          <p>{{ task.description }}</p>
          <p class="due-date">Due: {{ task.dueDate | date: 'mediumDate' }}</p>
          <p class="priority">Priority: {{ task.priority }}</p>
        </div>
      </div>

      <div class="task-actions">
        <button class="edit-btn" (click)="editTask(task)">✏️ Edit</button>
        <button class="delete-btn" (click)="deleteTask(task.id!)">🗑 Delete</button>
      </div>
    </li>
  </ul>
</div>
